require "codeclimate-test-reporter"
CodeClimate::TestReporter.start

require 'bundler/setup'
Bundler.setup

require 'card_connect_gateway'

VISA_APPROVAL_ACCOUNT = '4788250000121443'
VISA_REFER_CALL_ACCOUNT = '4387751111111020'
VISA_DO_NOT_HONOR_ACCOUNT = '4387751111111038'
VISA_CARD_EXPIRED_ACCOUNT = '4387751111111046'
VISA_INSUFFICIENT_FUNDS_ACCOUNT = '4387751111111053'

MASTERCARD_APPROVAL_ACCOUNT = '5454545454545454'
MASTERCARD_REFER_CALL_ACCOUNT = '5442981111111023'
MASTERCARD_DO_NOT_HONOR_ACCOUNT = '5442981111111031'
MASTERCARD_CARD_EXPIRED_ACCOUNT = '5442981111111049'
MASTERCARD_INSUFFICIENT_FUNDS_ACCOUNT = '5442981111111056'

DISCOVER_APPROVAL_ACCOUNT = '6011000995500000'
DISCOVER_REFER_CALL_ACCOUNT = '6011000995511122'
DISCOVER_DO_NOT_HONOR_ACCOUNT = '6011000995511130'
DISCOVER_CARD_EXPIRED_ACCOUNT = '6011000995511148'
DISCOVER_INSUFFICIENT_FUNDS_ACCOUNT = '6011000995511155'

AMEX_APPROVAL_ACCOUNT = '371449635398431'
DINERS_APPROVAL_ACCOUNT = '36438999960016'
JCB_APPROVAL_ACCOUNT = '3528000000000007'

APPROVAL_ACCOUNTS = [
  VISA_APPROVAL_ACCOUNT, 
  MASTERCARD_APPROVAL_ACCOUNT, 
  AMEX_APPROVAL_ACCOUNT, 
  DISCOVER_APPROVAL_ACCOUNT, 
  DINERS_APPROVAL_ACCOUNT, 
  JCB_APPROVAL_ACCOUNT
]

REFER_CALL_ACCOUNTS = [
  VISA_REFER_CALL_ACCOUNT, 
  MASTERCARD_REFER_CALL_ACCOUNT,
  DISCOVER_REFER_CALL_ACCOUNT
]

DO_NOT_HONOR_ACCOUNTS = [
  VISA_DO_NOT_HONOR_ACCOUNT,
  MASTERCARD_DO_NOT_HONOR_ACCOUNT,
  DISCOVER_DO_NOT_HONOR_ACCOUNT
]

CARD_EXPIRED_ACCOUNTS = [
  VISA_CARD_EXPIRED_ACCOUNT,
  MASTERCARD_CARD_EXPIRED_ACCOUNT,
  DISCOVER_CARD_EXPIRED_ACCOUNT
]

INSUFFICIENT_FUNDS_ACCOUNT = [
  VISA_INSUFFICIENT_FUNDS_ACCOUNT,
  MASTERCARD_INSUFFICIENT_FUNDS_ACCOUNT,
  DISCOVER_INSUFFICIENT_FUNDS_ACCOUNT
]

VISA_AVS_MATCH_ZIP = '19406'
VISA_AVS_PARTIAL_MATCH_ZIP = '19113'
MASTERCARD_ZIP_MISMATCH = '19111'
MASTERCARD_AVS_MISMATCH = '19112'

EXPIRY = "12#{(Time.now.year+1).to_s[2..-1]}"

CVV_MATCH = '112'
CVV_MISMATCH = '111'
CVV_NOT_PROCESSED = '222'
CVV_UNKNOWN = '333'

RSpec.configure do |config|
  config.before(:each) {
    CardConnectGateway.configure do |config|
      config.test_mode = true
      config.merchant_id = ENV["CARD_CONNECT_MERCHANT_ID"]
      config.user_id = ENV['CARD_CONNECT_USER_ID']
      config.password = ENV['CARD_CONNECT_PASSWORD']
      config.debug = true
      config.require_avs_zip_code_match = false
      config.require_avs_address_match = false
      config.require_avs_customer_name_match = false
      config.supported_card_types = [
        CardConnectGateway::Base::VISA, 
        CardConnectGateway::Base::MASTERCARD, 
        CardConnectGateway::Base::AMEX, 
        CardConnectGateway::Base::DISCOVER, 
        CardConnectGateway::Base::MAESTRO, 
        CardConnectGateway::Base::DINERS_CLUB, 
        CardConnectGateway::Base::JCB
      ]
    end
  }

end
